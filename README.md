# CopyDoc-CSV-to-Word-Convertor

A Streamlit web application for converting between CSV and Word documents for Figma copy management workflows.

Live app: https://tw-copydoc-csv-to-word-convertor.streamlit.app/

## Features

- **CSV → Word**: Convert CSV data into a formatted Word document with section headings and tables.
- **Word → CSV (update existing)**: Upload the original CSV and an edited Word document to extract changes back into CSV, preserving structure.
- **Word → New CSV**: Convert a Word document directly into a new CSV with the standard columns.
- **Enhanced formatting preservation**: Choose to preserve bold/italic/list formatting and Word headings (Heading 1–6) as Markdown, or extract plain text. **Numbered lists** (1., 2., a., i., etc.) keep their original numbering format.
- **Interactive UI**: Streamlit-based UI with upload previews and download buttons.

## Project Structure

```
CopyDoc-CSV-to-Word-Convertor/
├── app.py                      # Main Streamlit application
├── requirements.txt            # Python dependencies
├── README.md                   # This file
├── data/
│   └── bbsc-home-copy-export-tests-v2.csv  # Sample data
└── src/
    └── figma_copy_workflow/
        ├── __init__.py
        ├── helpers.py          # Utilities for CSV/Word processing
        └── parser.py           # High-level conversion functions
```

## Installation

1. Clone the project
   ```bash
   git clone <repository-url>
   cd CopyDoc-CSV-to-Word-Convertor
   ```

2. Create a virtual environment (recommended)
   ```bash
   python -m venv venv
   source venv/bin/activate  # Windows: venv\Scripts\activate
   ```

3. Install dependencies
   ```bash
   pip install -r requirements.txt
   ```

## Running the application

Local development:
```bash
streamlit run app.py
```

By default, Streamlit serves at `http://localhost:8501`. If the port is busy:
```bash
streamlit run app.py --server.port=8502
```

## Usage

- **CSV → Word**
  - Select "CSV to Word" in the sidebar
  - Upload a CSV file with columns: `id, frame, group, layer_name, figma_text` (others are preserved if present)
  - Click "Convert to Word" and download the generated `.docx`

- **Word → CSV (update existing)**
  - Select "Word to CSV"
  - Upload the original CSV and the edited Word document generated by this app
  - Choose whether to preserve formatting
  - Download the updated CSV

- **Word → New CSV**
  - Select "Word to New CSV"
  - Upload any compatible Word document following the structure below
  - Choose whether to preserve formatting
  - Download the generated CSV

### Word document expectations

- Headings (Word Heading 1–6) in the document are treated as section names (used for `frame` and `group`).
- Tables should be shaped like one of:
  - `Label | Text | ID`
  - `ID | Label | Text`
  - `Label | Text` (an ID will be generated)

When formatting preservation is enabled, headings and text formatting are preserved as Markdown:

**Headings:**
- Word Heading 1–6 → `#`, `##`, `###`, `####`, `#####`, `######`
- Only standard Word headings are converted to Markdown headings

**Text Formatting:**
- `**bold text**` for bold
- `*italic text*` for italic  
- `***bold italic***` for both

**List Preservation:**
- **Numbered lists**: Original numbering is preserved (e.g., `1. First item`, `2. Second item`, `a. Letter item`, `i. Roman numeral`)
- **Unordered lists**: Converted to Markdown format (`- Bullet item`)
- **Supported numbered formats**: `1.`, `2)`, `a.`, `A)`, `i.`, `IV.`, and more

## Dependencies

- `streamlit>=1.47.1`
- `pandas>=2.3.1`
- `python-docx>=1.1.0`

## Notes

- The app modifies `sys.path` in `app.py` to include the `src` directory so the `figma_copy_workflow` package can be imported without extra environment setup.
- Sample CSV available in `data/` for testing.

## Troubleshooting

- **Port already in use**: Run with a different port: `streamlit run app.py --server.port=8502`.
- **Import errors**: Ensure dependencies are installed: `pip install -r requirements.txt`.
- **CSV encoding**: Use UTF-8 encoded CSV files. The reader will handle BOMs.
- **Word format**: Only `.docx` files are supported.

## License

This project is open source and available under the MIT License.
